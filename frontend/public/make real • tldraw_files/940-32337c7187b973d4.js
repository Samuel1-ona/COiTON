"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[940],{5575:function(e,t,o){o.d(t,{B:function(){return PreviewShapeUtil}});var n=o(7437),r=o(5966),a=o(2265),i=o(7544),s=o(2238),l=o(352);async function createReplitProject(e){console.log("fetching from replit");try{let t=await fetch("/api/replit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html:e})}).then(async e=>e.json());if(t.success)return{error:void 0,url:t.link}}catch(e){console.error(e.message)}return{error:!0,url:void 0}}function createStackBlitzProject(e){return{title:"Make real from tldraw",description:"Your AI generated example made at https://makereal.tldraw.com/",template:"html",files:{"index.html":e}}}function getCodeSandboxUrl(e){let t=createCodeSandboxProject(e);return"https://codesandbox.io/api/v1/sandboxes/define?parameters=".concat(t)}function compress(e){return l.compressToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function createCodeSandboxProject(e){return compress(JSON.stringify({files:{"index.html":{content:e,isBinary:!1}}}))}function Dropdown(e){let{boxShadow:t,children:o,html:l,uploadUrl:c}=e,d=(0,r.useToasts)(),p=(0,a.useCallback)(()=>{navigator&&navigator.clipboard&&(navigator.clipboard.writeText(c),d.addToast({icon:"link",title:"Copied link to clipboard"}))},[c,d]),u=(0,a.useCallback)(()=>{navigator&&navigator.clipboard&&(navigator.clipboard.writeText(l),d.addToast({icon:"code",title:"Copied html to clipboard"}))},[l,d]),h=(0,a.useCallback)(()=>{try{let e=getCodeSandboxUrl(l);window.open(e)}catch(e){d.addToast({title:"There was a problem opening in CodeSandbox."})}},[l,d]),g=(0,a.useCallback)(()=>{try{let e=createStackBlitzProject(l);s.Z.openProject(e,{openFile:"index.html"})}catch(e){d.addToast({title:"There was a problem opening in Stackblitz."})}},[l,d]),m=(0,a.useCallback)(async()=>{try{let{error:e,url:t}=await createReplitProject(l);if(console.log(e,t),e)throw console.error(e),Error();window.open(t)}catch(e){d.addToast({title:"There was a problem opening in Replit."})}},[l,d]);return(0,n.jsxs)(i.fC,{children:[(0,n.jsx)(i.xz,{asChild:!0,children:o}),(0,n.jsx)(i.Uv,{children:(0,n.jsx)(i.VY,{side:"right",sideOffset:10,align:"start",children:(0,n.jsxs)("div",{style:{boxShadow:t,pointerEvents:"all",background:"#fdfdfd"},className:"flex items-start flex-col text-xs bg-white rounded-[9px] w-full p-1",children:[(0,n.jsx)(Item,{action:p,children:"Copy link"}),(0,n.jsx)(Item,{action:u,children:"Copy HTML"}),(0,n.jsx)("div",{style:{height:"1px",margin:"4px -4px",width:"calc(100% + 8px)",background:"#e8e8e8"}}),(0,n.jsx)(Item,{action:()=>window.open(c),children:"Open in new tab"}),(0,n.jsx)(Item,{action:h,children:"Open in CodeSandbox"}),(0,n.jsx)(Item,{action:g,children:"Open in StackBlitz"}),(0,n.jsx)(Item,{action:m,children:"Open in Replit"})]})})})]})}function Item(e){let{action:t,children:o}=e;return(0,n.jsx)(i.ck,{asChild:!0,children:(0,n.jsx)("button",{onPointerDown:r.stopEventPropagation,onClick:t,onTouchEnd:t,className:" hover:bg-gray-100 outline-none h-9 px-3 text-left w-full rounded-md box-border",style:{textShadow:"1px 1px #fff"},children:o})})}var c=o(7693);let PreviewShapeUtil=class PreviewShapeUtil extends r.BaseBoxShapeUtil{getDefaultProps(){return{html:"",source:"",w:640,h:360,dateCreated:Date.now()}}component(e){let t=(0,r.useIsEditing)(e.id);(0,r.useToasts)();let o=(0,r.useValue)("box shadow",()=>{let t=this.editor.getShapePageTransform(e).rotation();return getRotatedBoxShadow(t)},[this.editor]),{html:i,linkUploadVersion:s,uploadedShapeId:l}=e.props;(0,a.useEffect)(()=>{let t=!1;return i&&(void 0===s||l!==e.id)&&(async()=>{await (0,c.x)(e.id,i),t||this.editor.updateShape({id:e.id,type:"preview",props:{linkUploadVersion:1,uploadedShapeId:e.id}})})(),()=>{t=!0}},[e.id,i,s,l]);let d=void 0===s||l!==e.id,p=["https://","makereal.tldraw.link","/",e.id.replace(/^shape:/,"")].join("");return(0,n.jsx)(r.HTMLContainer,{className:"tl-embed-container",id:e.id,children:d?(0,n.jsx)("div",{style:{width:"100%",height:"100%",backgroundColor:"var(--color-culled)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:o,border:"1px solid var(--color-panel-contrast)",borderRadius:"var(--radius-2)"},children:(0,n.jsx)(r.DefaultSpinner,{})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("iframe",{id:"iframe-1-".concat(e.id),src:"".concat(p,"?preview=1&v=").concat(s),width:(0,r.toDomPrecision)(e.props.w),height:(0,r.toDomPrecision)(e.props.h),draggable:!1,style:{backgroundColor:"var(--color-panel)",pointerEvents:t?"auto":"none",boxShadow:o,border:"1px solid var(--color-panel-contrast)",borderRadius:"var(--radius-2)"}}),(0,n.jsx)("div",{style:{all:"unset",position:"absolute",top:-3,right:-45,height:40,width:40,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",pointerEvents:"all"},children:(0,n.jsx)(Dropdown,{boxShadow:o,html:e.props.html,uploadUrl:p,children:(0,n.jsx)("button",{className:"bg-white rounded p-2",style:{boxShadow:o},children:(0,n.jsx)(r.TldrawUiIcon,{icon:"dots-vertical"})})})}),(0,n.jsx)("div",{style:{textAlign:"center",position:"absolute",bottom:t?-40:0,padding:4,fontFamily:"inherit",fontSize:12,left:0,width:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:(0,n.jsx)("span",{style:{background:"var(--color-panel)",padding:"4px 12px",borderRadius:99,border:"1px solid var(--color-muted-1)"},children:t?"Click the canvas to exit":"Double click to interact"})})]})})}toSvg(e,t){let o=document.createElementNS("http://www.w3.org/2000/svg","g");return new Promise((t,n)=>{if(void 0===window)return t(o);let windowListener=n=>{var a;if(n.data.screenshot&&(null===(a=n.data)||void 0===a?void 0:a.shapeid)===e.id){let a=document.createElementNS("http://www.w3.org/2000/svg","image");a.setAttributeNS("http://www.w3.org/1999/xlink","href",n.data.screenshot),a.setAttribute("width",e.props.w.toString()),a.setAttribute("height",e.props.h.toString()),o.appendChild(a),window.removeEventListener("message",windowListener),clearTimeout(r),t(o)}},r=setTimeout(()=>{t(o),window.removeEventListener("message",windowListener)},2e3);window.addEventListener("message",windowListener);let a=document.getElementById("iframe-1-".concat(e.id));a?a.contentWindow.postMessage({action:"take-screenshot",shapeid:e.id},"*"):console.log("first level iframe not found or not accessible")})}indicator(e){return(0,n.jsx)("rect",{width:e.props.w,height:e.props.h})}constructor(...e){super(...e),this.canEdit=()=>!0,this.isAspectRatioLocked=e=>!1,this.canResize=e=>!0,this.canBind=e=>!1,this.canUnmount=()=>!1}};PreviewShapeUtil.type="preview";let d=[{offsetX:0,offsetY:2,blur:4,spread:-1,color:"#0000003a"},{offsetX:0,offsetY:3,blur:12,spread:-2,color:"#0000001f"}];function getRotatedBoxShadow(e){let t=d.map(t=>{let{offsetX:o,offsetY:n,blur:a,spread:i,color:s}=t,l=new r.Vec(o,n),{x:c,y:d}=l.rot(-e);return"".concat(c,"px ").concat(d,"px ").concat(a,"px ").concat(i,"px ").concat(s)});return t.join(", ")}},2287:function(e,t,o){o.d(t,{B:function(){return APIKeyInput}});var n=o(7437),r=o(5966),a=o(2265),i=o(5219);function APIKeyInput(){var e;let t=(0,r.useBreakpoint)(),[o,s]=(0,a.useState)(!1),l=(0,r.useEditor)(),c=(0,r.useValue)("is focus mode",()=>l.getInstanceState().isFocusMode,[l]),d=(0,a.useCallback)(e=>{localStorage.setItem("makeitreal_key",e.target.value)},[]),p=(0,a.useCallback)(e=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),e.currentTarget.blur(),s(!0),(0,i.setTimeout)(()=>s(!1),1200))},[]);return c?null:(0,n.jsx)("div",{className:"your-own-api-key ".concat(t<6?"your-own-api-key__mobile":""),children:(0,n.jsxs)("div",{className:"your-own-api-key__inner",children:[(0,n.jsx)("div",{className:"input__wrapper",children:(0,n.jsx)("input",{id:"openai_key_risky_but_cool",defaultValue:null!==(e=localStorage.getItem("makeitreal_key"))&&void 0!==e?e:"",onChange:d,onKeyDown:p,spellCheck:!1,autoCapitalize:"off"})}),(0,n.jsx)("a",{className:"question__button",target:"_blank",href:"https://tldraw.notion.site/Make-Real-FAQs-93be8b5273d14f7386e14eb142575e6e?pvs=4",children:(0,n.jsx)(r.TldrawUiIcon,{icon:o?"check":"question"})})]})})}},6081:function(e,t,o){o.d(t,{j:function(){return ExportButton}});var n=o(7437),r=o(5966),a=o(4441),i=o(2265);function blobToBase64(e){return new Promise((t,o)=>{let n=new FileReader;n.onloadend=()=>t(n.result),n.readAsDataURL(e)})}async function getHtmlFromOpenAI(e){let{image:t,apiKey:o,text:n,grid:r,theme:a="light",previousPreviews:i}=e;if(!o)throw Error("You need to provide an API key (sorry)");let s=[{role:"system",content:"You are an expert web developer who specializes in building working website prototypes from low-fidelity wireframes. Your job is to accept low-fidelity designs and turn them into interactive and responsive working prototypes. When sent new designs, you should reply with a high fidelity working prototype as a single HTML file.\n\nUse tailwind CSS for styling. If you must use other CSS, place it in a style tag.\n\nPut any JavaScript in a script tag. Use unpkg or skypack to import any required JavaScript dependencies. Use Google fonts to pull in any open source fonts you require. If you have any images, load them from Unsplash or use solid colored rectangles as placeholders. \n\nThe designs may include flow charts, diagrams, labels, arrows, sticky notes, screenshots of other applications, or even previous designs. Treat all of these as references for your prototype. Use your best judgement to determine what is an annotation and what should be included in the final result. Treat anything in the color red as an annotation rather than part of the design. Do NOT include any of those annotations in your final result.\n\nYour prototype should look and feel much more complete and advanced than the wireframes provided. Flesh it out, make it real! Try your best to figure out what the designer wants and make it happen. If there are any questions or underspecified features, use what you know about applications, user experience, and website design patterns to \"fill in the blanks\". If you're unsure of how the designs should work, take a guess—it's better for you to get it wrong than to leave things incomplete. \n\nRemember: you love your designers and want them to be happy. The more complete and impressive your prototype, the happier they will be. Good luck, you've got this!"},{role:"user",content:[]}],l=s[1].content;l.push({type:"text",text:i.length>0?"Here are the latest wireframes. There are also some previous outputs here. Could you make a new website based on these wireframes and notes and send back just the html file?":"Here are the latest wireframes. There are also some previous outputs here. We have run their code through an 'HTML to screenshot' library, that attempts to generate a screenshot of the page. The generated screenshot may have some inaccuracies, so use your knowledge of HTML and web development to figure out what any annotations are referring to, which may be different to what is visible in the generated screenshot. Make a new website based on these wireframes and notes and send back just the HTML file contents."}),l.push({type:"image_url",image_url:{url:t,detail:"high"}}),n&&l.push({type:"text",text:"Here's a list of all the text that we found in the design. Use it as a reference if anything is hard to read in the screenshot(s):\n".concat(n)}),r&&l.push({type:"text",text:"The designs have a ".concat(r.color," grid overlaid on top. Each cell of the grid is ").concat(r.size,"x").concat(r.size,"px.")});for(let e=0;e<i.length;e++){let t=i[e];l.push({type:"text",text:"The designs also included one of your previous result. Here's the image that you used as its source:"},{type:"image_url",image_url:{url:t.props.source,detail:"high"}},{type:"text",text:"And here's the HTML you came up with for it: ".concat(t.props.html)})}l.push({type:"text",text:"Please make your result use the ".concat(a," theme.")});let c=null;try{let e=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify({model:"gpt-4-turbo",max_tokens:4096,temperature:0,messages:s,seed:42,n:1})});c=await e.json()}catch(e){throw Error("Could not contact OpenAI: ".concat(e.message))}return c}function getSelectionAsText(e){let t=e.getSelectedShapeIds(),o=e.getShapeAndDescendantIds(t),n=Array.from(o).map(t=>{let o=e.getShape(t);return o}).filter(e=>"text"===e.type||"geo"===e.type||"arrow"===e.type||"note"===e.type).sort((t,o)=>{let n=e.getShapePageBounds(t),r=e.getShapePageBounds(o);return n.y===r.y?n.x<r.x?-1:1:n.y<r.y?-1:1}).map(e=>{var t;if(!e)return null;let o=null!==(t=e.props.text)&&void 0!==t?t:null;return"red"===e.props.color?"Annotation: ".concat(o):o}).filter(e=>!!e);return n.join("\n")}var s=o(7693);async function makeReal(e,t){let o=e.getSelectedShapes();if(0===o.length)throw Error("First select something to make real.");let{maxX:n,midY:i}=e.getSelectionPageBounds(),l=(0,r.createShapeId)();e.createShape({id:l,type:"preview",x:n+60,y:i-180,props:{html:"",source:""}});let c=await e.getSvg(o,{scale:1,background:!0});if(!c)throw Error("Could not get the SVG.");let d=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),p=await (0,r.getSvgAsImage)(c,d,{type:"png",quality:.8,scale:1}),u=await blobToBase64(p),h=o.filter(e=>"preview"===e.type);h.length>0&&(0,a.track)("repeat_make_real",{timestamp:Date.now()});try{let o=await getHtmlFromOpenAI({image:u,apiKey:t,text:getSelectionAsText(e),previousPreviews:h,theme:e.user.getUserPreferences().isDarkMode?"dark":"light"});if(!o)throw Error("Could not contact OpenAI.");if(null==o?void 0:o.error){var g;throw console.error(o.error.message),Error("".concat(null===(g=o.error.message)||void 0===g?void 0:g.slice(0,128),"..."))}let n=o.choices[0].message.content,r=n.indexOf("<!DOCTYPE html>"),a=n.indexOf("</html>"),i=n.slice(r,a+7);if(i.length<100)throw console.warn(n),Error("Could not generate a design from those wireframes.");await (0,s.x)(l,i),e.updateShape({id:l,type:"preview",props:{html:i,source:u,linkUploadVersion:1,uploadedShapeId:l}}),console.log("Response: ".concat(n))}catch(t){throw e.deleteShape(l),t}}function useMakeReal(){let e=(0,r.useEditor)(),t=(0,r.useToasts)();return(0,i.useCallback)(async()=>{var o;let n=document.getElementById("openai_key_risky_but_cool"),r=null!==(o=null==n?void 0:n.value)&&void 0!==o?o:null;(0,a.track)("make_real",{timestamp:Date.now()});try{await makeReal(e,r)}catch(e){(0,a.track)("no_luck",{timestamp:Date.now()}),console.error(e),t.addToast({title:"Something went wrong",description:"".concat(e.message.slice(0,200)),actions:[{type:"primary",label:"Read the guide",onClick:()=>{window.open("https://tldraw.notion.site/Make-Real-FAQs-93be8b5273d14f7386e14eb142575e6e","_blank")}}]})}},[e,t])}function ExportButton(){let e=useMakeReal();return(0,n.jsx)("button",{onClick:e,className:"p-2",style:{cursor:"pointer",zIndex:1e5,pointerEvents:"all"},children:(0,n.jsx)("div",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Make Real"})})}},8907:function(e,t,o){o.d(t,{T:function(){return LinkArea}});var n=o(7437),r=o(5966),a=o(4441);function LinkArea(){let e=(0,r.useBreakpoint)(),t=(0,r.useEditor)(),o=(0,r.useValue)("isFocusMode",()=>t.getInstanceState().isFocusMode,[t]);return o?null:(0,n.jsx)("span",{className:"lockup__link ".concat(e<6?"lockup__link__mobile":""," flex mb-1 items-center justify-center"),children:(0,n.jsx)("a",{href:"https://twitter.com/tldraw",onClick:()=>(0,a.track)("lockup_clicked",{timestamp:Date.now()}),children:(0,n.jsx)("img",{alt:"tldraw logo",className:"lockup",src:"/lockup.svg"})})})}},7693:function(e,t,o){o.d(t,{x:function(){return n}}),o(5231),o(470);var n=(0,o(3545).$)("2816bf227472f996e45ae7f7fa3c60dd5f00e09d")}}]);